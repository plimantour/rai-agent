<div id="live-progress"
    class="progress-feed{% if not progress_active and not progress_messages %} is-hidden{% endif %}"
     data-progress-active="{{ 'true' if progress_active else 'false' }}"
     hx-get="/progress"
    hx-target="this"
    hx-trigger="load delay:500ms, every 2s [this.dataset.progressActive === 'true']"
     hx-vals='{"version": "{{ progress_version }}"}'
     hx-swap="outerHTML">
    {% if progress_messages %}
    <div class="progress-panel">
        <h4>Live processing</h4>
        <div class="progress-list">
        {% for step in progress_messages %}
            {% if step.heading is defined %}
            <div class="progress-item">
                <span class="step-heading">{{ step.heading }}</span>
                {% if step.subtext %}
                <p class="muted small step-detail">{{ step.subtext }}</p>
                {% endif %}
            </div>
            {% else %}
            <div class="progress-item">
                <span class="step-heading">{{ step }}</span>
            </div>
            {% endif %}
        {% endfor %}
        </div>
    </div>
    {% elif progress_active %}
    <div class="progress-panel">
        <h4>Live processing</h4>
        <p class="muted small">Preparing to generateâ€¦</p>
    </div>
    {% else %}
    <!-- No active progress -->
    {% endif %}
</div>
